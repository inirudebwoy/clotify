(ns clotify.playlist
  (:require [clojure.data.json :as json]))

(def spotify-playlist-tracks-stub "{\n  \"href\" : \"https://api.spotify.com/v1/users/jmperezperez/playlists/3cEYpjA9oz9GiPac4AsH4n/tracks?offset=0&limit=100&market=ES\",\n  \"items\" : [ {\n    \"added_at\" : \"2015-01-15T12:39:22Z\",\n    \"added_by\" : {\n      \"external_urls\" : {\n        \"spotify\" : \"http://open.spotify.com/user/jmperezperez\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/users/jmperezperez\",\n      \"id\" : \"jmperezperez\",\n      \"type\" : \"user\",\n      \"uri\" : \"spotify:user:jmperezperez\"\n    },\n    \"is_local\" : false,\n    \"track\" : {\n      \"album\" : {\n        \"album_type\" : \"album\",\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/album/2pANdqPvxInB0YvcDiw4ko\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/albums/2pANdqPvxInB0YvcDiw4ko\",\n        \"id\" : \"2pANdqPvxInB0YvcDiw4ko\",\n        \"images\" : [ {\n          \"height\" : 640,\n          \"url\" : \"https://i.scdn.co/image/599c4ead3874e1e66368e8cf3721b9f79116b328\",\n          \"width\" : 640\n        }, {\n          \"height\" : 300,\n          \"url\" : \"https://i.scdn.co/image/6f31225bf642a58f29a80ca51769c8c588cccdee\",\n          \"width\" : 300\n        }, {\n          \"height\" : 64,\n          \"url\" : \"https://i.scdn.co/image/1a8532495d73b657d592196bfdd9cb980f61443f\",\n          \"width\" : 64\n        } ],\n        \"name\" : \"Progressive Psy Trance Picks Vol.8\",\n        \"type\" : \"album\",\n        \"uri\" : \"spotify:album:2pANdqPvxInB0YvcDiw4ko\"\n      },\n      \"artists\" : [ {\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/artist/6eSdhw46riw2OUHgMwR8B5\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/artists/6eSdhw46riw2OUHgMwR8B5\",\n        \"id\" : \"6eSdhw46riw2OUHgMwR8B5\",\n        \"name\" : \"Odiseo\",\n        \"type\" : \"artist\",\n        \"uri\" : \"spotify:artist:6eSdhw46riw2OUHgMwR8B5\"\n      } ],\n      \"disc_number\" : 1,\n      \"duration_ms\" : 376000,\n      \"explicit\" : false,\n      \"external_ids\" : {\n        \"isrc\" : \"DEKC41200989\"\n      },\n      \"external_urls\" : {\n        \"spotify\" : \"https://open.spotify.com/track/4rzfv0JLZfVhOhbSQ8o5jZ\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/tracks/4rzfv0JLZfVhOhbSQ8o5jZ\",\n      \"id\" : \"4rzfv0JLZfVhOhbSQ8o5jZ\",\n      \"is_playable\" : true,\n      \"name\" : \"Api\",\n      \"popularity\" : 8,\n      \"preview_url\" : \"https://p.scdn.co/mp3-preview/c440fa9ff320fb74629f8477bff45b1a377897ab\",\n      \"track_number\" : 10,\n      \"type\" : \"track\",\n      \"uri\" : \"spotify:track:4rzfv0JLZfVhOhbSQ8o5jZ\"\n    }\n  }, {\n    \"added_at\" : \"2015-01-15T12:40:03Z\",\n    \"added_by\" : {\n      \"external_urls\" : {\n        \"spotify\" : \"http://open.spotify.com/user/jmperezperez\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/users/jmperezperez\",\n      \"id\" : \"jmperezperez\",\n      \"type\" : \"user\",\n      \"uri\" : \"spotify:user:jmperezperez\"\n    },\n    \"is_local\" : false,\n    \"track\" : {\n      \"album\" : {\n        \"album_type\" : \"compilation\",\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/album/6nlfkk5GoXRL1nktlATNsy\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/albums/6nlfkk5GoXRL1nktlATNsy\",\n        \"id\" : \"6nlfkk5GoXRL1nktlATNsy\",\n        \"images\" : [ {\n          \"height\" : 640,\n          \"url\" : \"https://i.scdn.co/image/385bd8f5109c00d9b43842ba5b99e9e82f7156f8\",\n          \"width\" : 640\n        }, {\n          \"height\" : 300,\n          \"url\" : \"https://i.scdn.co/image/4a06e9a60a90529dea773326219ae6d4c7c422c2\",\n          \"width\" : 300\n        }, {\n          \"height\" : 64,\n          \"url\" : \"https://i.scdn.co/image/d076d09bea0978819ade083856f80d73e2438adc\",\n          \"width\" : 64\n        } ],\n        \"name\" : \"Wellness & Dreaming Source\",\n        \"type\" : \"album\",\n        \"uri\" : \"spotify:album:6nlfkk5GoXRL1nktlATNsy\"\n      },\n      \"artists\" : [ {\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/artist/5VQE4WOzPu9h3HnGLuBoA6\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/artists/5VQE4WOzPu9h3HnGLuBoA6\",\n        \"id\" : \"5VQE4WOzPu9h3HnGLuBoA6\",\n        \"name\" : \"Vlasta Marek\",\n        \"type\" : \"artist\",\n        \"uri\" : \"spotify:artist:5VQE4WOzPu9h3HnGLuBoA6\"\n      } ],\n      \"disc_number\" : 1,\n      \"duration_ms\" : 730066,\n      \"explicit\" : false,\n      \"external_ids\" : {\n        \"isrc\" : \"FR2X41475057\"\n      },\n      \"external_urls\" : {\n        \"spotify\" : \"https://open.spotify.com/track/5o3jMYOSbaVz3tkgwhELSV\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/tracks/5o3jMYOSbaVz3tkgwhELSV\",\n      \"id\" : \"5o3jMYOSbaVz3tkgwhELSV\",\n      \"is_playable\" : true,\n      \"name\" : \"Is\",\n      \"popularity\" : 0,\n      \"preview_url\" : \"https://p.scdn.co/mp3-preview/4be8428736a05e8803ff1e455a738bff1d20bcaa\",\n      \"track_number\" : 21,\n      \"type\" : \"track\",\n      \"uri\" : \"spotify:track:5o3jMYOSbaVz3tkgwhELSV\"\n    }\n  }, {\n    \"added_at\" : \"2015-01-15T12:22:30Z\",\n    \"added_by\" : {\n      \"external_urls\" : {\n        \"spotify\" : \"http://open.spotify.com/user/jmperezperez\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/users/jmperezperez\",\n      \"id\" : \"jmperezperez\",\n      \"type\" : \"user\",\n      \"uri\" : \"spotify:user:jmperezperez\"\n    },\n    \"is_local\" : false,\n    \"track\" : {\n      \"album\" : {\n        \"album_type\" : \"album\",\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/album/4hnqM0JK4CM1phwfq1Ldyz\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/albums/4hnqM0JK4CM1phwfq1Ldyz\",\n        \"id\" : \"4hnqM0JK4CM1phwfq1Ldyz\",\n        \"images\" : [ {\n          \"height\" : 640,\n          \"url\" : \"https://i.scdn.co/image/7c2ddcaf6e3aacc89a6470dcac04cb58c9a42306\",\n          \"width\" : 640\n        }, {\n          \"height\" : 300,\n          \"url\" : \"https://i.scdn.co/image/69307d705b035be9c3c4a044f8323a85b1a85b3e\",\n          \"width\" : 300\n        }, {\n          \"height\" : 64,\n          \"url\" : \"https://i.scdn.co/image/8b3888b33e9d99f102a05779950bb833fa62d0f9\",\n          \"width\" : 64\n        } ],\n        \"name\" : \"This Is Happening\",\n        \"type\" : \"album\",\n        \"uri\" : \"spotify:album:4hnqM0JK4CM1phwfq1Ldyz\"\n      },\n      \"artists\" : [ {\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/artist/066X20Nz7iquqkkCW6Jxy6\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/artists/066X20Nz7iquqkkCW6Jxy6\",\n        \"id\" : \"066X20Nz7iquqkkCW6Jxy6\",\n        \"name\" : \"LCD Soundsystem\",\n        \"type\" : \"artist\",\n        \"uri\" : \"spotify:artist:066X20Nz7iquqkkCW6Jxy6\"\n      } ],\n      \"disc_number\" : 1,\n      \"duration_ms\" : 401440,\n      \"explicit\" : false,\n      \"external_ids\" : {\n        \"isrc\" : \"US4GE1000022\"\n      },\n      \"external_urls\" : {\n        \"spotify\" : \"https://open.spotify.com/track/4Cy0NHJ8Gh0xMdwyM9RkQm\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/tracks/4Cy0NHJ8Gh0xMdwyM9RkQm\",\n      \"id\" : \"4Cy0NHJ8Gh0xMdwyM9RkQm\",\n      \"is_playable\" : true,\n      \"name\" : \"All I Want\",\n      \"popularity\" : 46,\n      \"preview_url\" : \"https://p.scdn.co/mp3-preview/1dd960a5c02c5330a0d6578672971314d85adb75\",\n      \"track_number\" : 4,\n      \"type\" : \"track\",\n      \"uri\" : \"spotify:track:4Cy0NHJ8Gh0xMdwyM9RkQm\"\n    }\n  }, {\n    \"added_at\" : \"2015-01-15T12:40:35Z\",\n    \"added_by\" : {\n      \"external_urls\" : {\n        \"spotify\" : \"http://open.spotify.com/user/jmperezperez\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/users/jmperezperez\",\n      \"id\" : \"jmperezperez\",\n      \"type\" : \"user\",\n      \"uri\" : \"spotify:user:jmperezperez\"\n    },\n    \"is_local\" : false,\n    \"track\" : {\n      \"album\" : {\n        \"album_type\" : \"album\",\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/album/2usKFntxa98WHMcyW6xJBz\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/albums/2usKFntxa98WHMcyW6xJBz\",\n        \"id\" : \"2usKFntxa98WHMcyW6xJBz\",\n        \"images\" : [ {\n          \"height\" : 636,\n          \"url\" : \"https://i.scdn.co/image/8d044068c7140d1d39dc6951eff37ac6150b4e8b\",\n          \"width\" : 640\n        }, {\n          \"height\" : 298,\n          \"url\" : \"https://i.scdn.co/image/911ed9ef8d2e513b2cf90472394193b0ece315f7\",\n          \"width\" : 300\n        }, {\n          \"height\" : 64,\n          \"url\" : \"https://i.scdn.co/image/51e7b672cfc8f58c97f39704cb9687bdf2e89797\",\n          \"width\" : 64\n        } ],\n        \"name\" : \"Glenn Horiuchi Trio / Gelenn Horiuchi Quartet: Mercy / Jump Start / Endpoints / Curl Out / Earthworks / Mind Probe / Null Set / Another Space (A)\",\n        \"type\" : \"album\",\n        \"uri\" : \"spotify:album:2usKFntxa98WHMcyW6xJBz\"\n      },\n      \"artists\" : [ {\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/artist/272ArH9SUAlslQqsSgPJA2\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/artists/272ArH9SUAlslQqsSgPJA2\",\n        \"id\" : \"272ArH9SUAlslQqsSgPJA2\",\n        \"name\" : \"Glenn Horiuchi Trio\",\n        \"type\" : \"artist\",\n        \"uri\" : \"spotify:artist:272ArH9SUAlslQqsSgPJA2\"\n      } ],\n      \"disc_number\" : 1,\n      \"duration_ms\" : 358760,\n      \"explicit\" : false,\n      \"external_ids\" : {\n        \"isrc\" : \"USB8U1025969\"\n      },\n      \"external_urls\" : {\n        \"spotify\" : \"https://open.spotify.com/track/6hvFrZNocdt2FcKGCSY5NI\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/tracks/6hvFrZNocdt2FcKGCSY5NI\",\n      \"id\" : \"6hvFrZNocdt2FcKGCSY5NI\",\n      \"is_playable\" : true,\n      \"name\" : \"Endpoints\",\n      \"popularity\" : 0,\n      \"preview_url\" : \"https://p.scdn.co/mp3-preview/14301ef7f4f489d4a80a05afc34532b522cdeff0\",\n      \"track_number\" : 2,\n      \"type\" : \"track\",\n      \"uri\" : \"spotify:track:6hvFrZNocdt2FcKGCSY5NI\"\n    }\n  }, {\n    \"added_at\" : \"2015-01-15T12:41:10Z\",\n    \"added_by\" : {\n      \"external_urls\" : {\n        \"spotify\" : \"http://open.spotify.com/user/jmperezperez\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/users/jmperezperez\",\n      \"id\" : \"jmperezperez\",\n      \"type\" : \"user\",\n      \"uri\" : \"spotify:user:jmperezperez\"\n    },\n    \"is_local\" : false,\n    \"track\" : {\n      \"album\" : {\n        \"album_type\" : \"album\",\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/album/0ivM6kSawaug0j3tZVusG2\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/albums/0ivM6kSawaug0j3tZVusG2\",\n        \"id\" : \"0ivM6kSawaug0j3tZVusG2\",\n        \"images\" : [ {\n          \"height\" : 634,\n          \"url\" : \"https://i.scdn.co/image/fa826e26b0d7683327317d9f4a4909f64cab281b\",\n          \"width\" : 640\n        }, {\n          \"height\" : 297,\n          \"url\" : \"https://i.scdn.co/image/5421e1bb2497eee2ba437db930eb831d0669a66b\",\n          \"width\" : 300\n        }, {\n          \"height\" : 63,\n          \"url\" : \"https://i.scdn.co/image/e3c51dadaa16361d247bb38b6f9e505f8d5ae6b1\",\n          \"width\" : 64\n        } ],\n        \"name\" : \"All The Best (Spanish Version)\",\n        \"type\" : \"album\",\n        \"uri\" : \"spotify:album:0ivM6kSawaug0j3tZVusG2\"\n      },\n      \"artists\" : [ {\n        \"external_urls\" : {\n          \"spotify\" : \"https://open.spotify.com/artist/2KftmGt9sk1yLjsAoloC3M\"\n        },\n        \"href\" : \"https://api.spotify.com/v1/artists/2KftmGt9sk1yLjsAoloC3M\",\n        \"id\" : \"2KftmGt9sk1yLjsAoloC3M\",\n        \"name\" : \"Zucchero\",\n        \"type\" : \"artist\",\n        \"uri\" : \"spotify:artist:2KftmGt9sk1yLjsAoloC3M\"\n      } ],\n      \"disc_number\" : 1,\n      \"duration_ms\" : 176093,\n      \"explicit\" : false,\n      \"external_ids\" : {\n        \"isrc\" : \"ITUM70701043\"\n      },\n      \"external_urls\" : {\n        \"spotify\" : \"https://open.spotify.com/track/2E2znCPaS8anQe21GLxcvJ\"\n      },\n      \"href\" : \"https://api.spotify.com/v1/tracks/2E2znCPaS8anQe21GLxcvJ\",\n      \"id\" : \"2E2znCPaS8anQe21GLxcvJ\",\n      \"is_playable\" : true,\n      \"name\" : \"You Are So Beautiful\",\n      \"popularity\" : 25,\n      \"preview_url\" : \"https://p.scdn.co/mp3-preview/00d5de01b5e873fcf5a9dce6e7a5dbc0c45335d3\",\n      \"track_number\" : 18,\n      \"type\" : \"track\",\n      \"uri\" : \"spotify:track:2E2znCPaS8anQe21GLxcvJ\"\n    }\n  } ],\n  \"limit\" : 100,\n  \"next\" : null,\n  \"offset\" : 0,\n  \"previous\" : null,\n  \"total\" : 5\n}")

(def spotify-skip-track )

;; fetch tracks from spotify, parse into map (json/read-str)
(defn tracks [id] spotify-playlist-tracks-stub)
